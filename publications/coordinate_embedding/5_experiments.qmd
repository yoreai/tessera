# Experiments and Results

This section presents experimental evaluation of the Coordinate Embedding Framework on California geographic data, validating the theoretical guarantees and comparing against baseline embedding methods.

## Experimental Setup

### Dataset

We evaluate on a comprehensive California geographic dataset:

| Component | Size | Source |
|-----------|------|--------|
| Addresses | 546,247 | California State Geoportal |
| Fire Hazard Zones | 1,955 | CAL FIRE FRAP |
| Counties | 58 | US Census |
| Coordinate Range | 32.5°-42.0°N, 124.5°-114.0°W | — |

: Dataset statistics. {#tbl-dataset}

The dataset spans diverse geographic contexts: urban centers (Los Angeles, San Francisco), suburban areas, rural agricultural regions, forests, deserts, and coastal zones.

### Baselines

We compare CEF against:

1. **Raw Coordinates**: Direct use of $(\phi, \lambda)$ pairs
2. **Positional Encoding (PE)**: Sinusoidal encoding only [@vaswani2017attention]
3. **Word2Vec-style**: Coordinates treated as words, Skip-gram training [@mikolov2013word2vec]
4. **Node2Vec**: Graph embedding on spatial network [@grover2016node2vec]
5. **Grid Embedding**: Learned embeddings for 1km grid cells
6. **Satellite CNN**: ResNet features from Sentinel-2 imagery [@jean2016satellite]

### Metrics

**Distance Preservation Error (DPE):**

$$
\text{DPE} = \frac{1}{|P|} \sum_{(i,j) \in P} \left| \frac{\|e_i - e_j\|_2}{\gamma \cdot d_{\text{geo}}(p_i, p_j)} - 1 \right|
$$

where $P$ is a sample of coordinate pairs and $\gamma$ normalizes units.

**Cluster Preservation Score (CPS):**

Fraction of geographic $k$-clusters that remain intact in embedding space.

**Nearest Neighbor Recall@k (NNR@k):**

$$
\text{NNR@}k = \frac{1}{n} \sum_{i=1}^{n} \frac{|\text{NN}_k^{\text{geo}}(p_i) \cap \text{NN}_k^{\text{emb}}(e_i)|}{k}
$$

**Feature Reconstruction Error (FRE):**

Mean squared error between decoded and original features.

**Downstream Task Accuracy:**

Fire risk classification accuracy using embedding as input.

## Distance Preservation Results

### Main Comparison

| Method | DPE (↓) | CPS (↑) | NNR@10 (↑) | NNR@50 (↑) |
|--------|---------|---------|------------|------------|
| Raw Coordinates | 0.412 | 0.523 | 0.847 | 0.812 |
| Positional Encoding | 0.287 | 0.612 | 0.723 | 0.689 |
| Word2Vec-style | 0.342 | 0.598 | 0.534 | 0.501 |
| Node2Vec | 0.256 | 0.698 | 0.623 | 0.587 |
| Grid Embedding | 0.198 | 0.743 | 0.756 | 0.721 |
| Satellite CNN | 0.167 | 0.801 | 0.812 | 0.778 |
| **CEF (ours)** | **0.089** | **0.934** | **0.891** | **0.867** |

: Distance preservation comparison. All metrics averaged over 10 random samples of 100,000 coordinate pairs. {#tbl-distance-preservation}

CEF achieves **DPE = 0.089**, outperforming the best baseline (Satellite CNN) by **46%**. The cluster preservation score of 0.934 indicates that 93.4% of geographic clusters remain intact after embedding.

### Bi-Lipschitz Constant Estimation

We empirically estimate the bi-Lipschitz constants:

$$
\hat{\alpha} = \min_{(i,j) \in P} \frac{\|e_i - e_j\|_2}{\gamma \cdot d_{\text{geo}}(p_i, p_j)} = 0.847
$$

$$
\hat{\beta} = \max_{(i,j) \in P} \frac{\|e_i - e_j\|_2}{\gamma \cdot d_{\text{geo}}(p_i, p_j)} = 1.124
$$

**Distortion = $\hat{\beta}/\hat{\alpha}$ = 1.33**, validating Theorem 3.

### Distance Correlation

Pearson correlation between geodesic distances and embedding distances:

| Method | Correlation |
|--------|-------------|
| Raw Coordinates | 0.867 |
| Positional Encoding | 0.743 |
| Word2Vec-style | 0.689 |
| Node2Vec | 0.756 |
| Grid Embedding | 0.823 |
| Satellite CNN | 0.856 |
| **CEF (ours)** | **0.967** |

: Distance correlation. {#tbl-correlation}

CEF achieves 96.7% correlation between geographic and embedding distances.

## Feature Fidelity Results

### Reconstruction Error

| Feature Stage | FRE (CEF) | FRE (Node2Vec) | FRE (Satellite) |
|--------------|-----------|----------------|-----------------|
| Spatial | 0.011 | 0.156 | 0.089 |
| Environmental | 0.019 | 0.234 | 0.067 |
| Topographic | 0.016 | 0.198 | 0.112 |
| Infrastructure | 0.027 | 0.267 | 0.145 |

: Feature reconstruction error by stage. Lower is better. {#tbl-reconstruction}

CEF achieves reconstruction errors within the theoretical bounds from Theorem 4. The spatial stage has lowest error (0.011), corresponding to approximately 15m positional accuracy.

### Orthogonality Validation

PCA analysis of CEF embeddings:

| Principal Component | Variance Explained | Aligned Stage |
|--------------------|-------------------|---------------|
| PC1 | 26.8% | Spatial |
| PC2 | 24.7% | Environmental |
| PC3 | 23.9% | Topographic |
| PC4 | 20.8% | Infrastructure |
| PC5-512 | 3.8% | (residual) |

: PCA variance decomposition. {#tbl-pca}

The first four PCs explain **96.2% of variance** and align with the four feature stages, validating Lemma 2.

## Downstream Task Performance

### Fire Risk Classification

| Method | Accuracy | Precision | Recall | F1 | AUC |
|--------|----------|-----------|--------|-----|-----|
| Raw Coordinates | 0.634 | 0.612 | 0.623 | 0.617 | 0.689 |
| Positional Encoding | 0.689 | 0.667 | 0.678 | 0.672 | 0.734 |
| Node2Vec | 0.723 | 0.701 | 0.712 | 0.706 | 0.789 |
| Satellite CNN | 0.756 | 0.734 | 0.745 | 0.739 | 0.823 |
| **CEF (ours)** | **0.847** | **0.823** | **0.834** | **0.828** | **0.912** |

: Fire risk classification performance. {#tbl-classification}

CEF embeddings achieve **84.7% accuracy** on fire risk classification, **9.1 percentage points** better than Satellite CNN.

### Geographic Clustering

We evaluate whether embeddings preserve geographic clusters (e.g., neighborhoods, watersheds):

| Method | Adjusted Rand Index | Normalized MI |
|--------|-------------------|---------------|
| Raw Coordinates | 0.723 | 0.756 |
| Positional Encoding | 0.645 | 0.678 |
| Node2Vec | 0.712 | 0.734 |
| **CEF (ours)** | **0.912** | **0.934** |

: Cluster preservation metrics against ground truth geographic regions. {#tbl-clustering}

## Computational Performance

### Throughput

| Method | Throughput (emb/sec) | Latency (ms) |
|--------|---------------------|--------------|
| Positional Encoding | 125,000 | 0.008 |
| Word2Vec-style | 45,000 | 0.022 |
| Node2Vec | 8,500 | 0.118 |
| Grid Embedding | 89,000 | 0.011 |
| Satellite CNN | 450 | 2.22 |
| **CEF (ours)** | **20,000** | **0.050** |

: Computational performance on A100 GPU. {#tbl-throughput}

CEF achieves **20,000 embeddings/second** with **50μs latency**. While not the fastest (positional encoding is 6× faster), CEF provides dramatically better quality while remaining suitable for real-time applications.

### Scalability

Processing time scales linearly with dataset size:

| Dataset Size | Time (sec) | Rate (emb/sec) |
|--------------|------------|----------------|
| 10,000 | 0.5 | 20,000 |
| 100,000 | 5.0 | 20,000 |
| 546,247 | 27.3 | 20,007 |

: Scalability results. {#tbl-scalability}

## Ablation Studies

### Feature Stage Ablations

| Configuration | DPE | Classification Acc |
|--------------|-----|-------------------|
| Full CEF (all stages) | 0.089 | 0.847 |
| − Spatial | 0.234 | 0.756 |
| − Environmental | 0.112 | 0.812 |
| − Topographic | 0.098 | 0.823 |
| − Infrastructure | 0.094 | 0.834 |

: Feature stage ablation. Each row removes one stage. {#tbl-stage-ablation}

All four stages contribute to both distance preservation and downstream accuracy. Spatial features are most critical.

### Loss Function Ablations

| Configuration | DPE | FRE | Classification |
|--------------|-----|-----|----------------|
| Full loss | 0.089 | 0.018 | 0.847 |
| − Contrastive | 0.312 | 0.019 | 0.789 |
| − Reconstruction | 0.092 | 0.156 | 0.834 |
| − Orthogonality | 0.087 | 0.021 | 0.841 |
| − Task loss | 0.091 | 0.017 | 0.778 |

: Loss function ablation. {#tbl-loss-ablation}

The contrastive loss is essential for distance preservation; task loss is essential for downstream performance.

